% !TEX root = ../main.tex
\section{Algebraic Geometry using Schemes}

\subsection{Sheaves \& Presheaves}

\subsubsection{Presheaves}

\begin{definition}
    Consider a category $\mathcal{C}$. A \emph{presheaf} on $\mathcal{C}$ is a contravariant functor $\pazocal{F}: \mathcal{C}\rightarrow \mathrm{Set}$.\\
    For a subcategory $\mathcal{C}'$ of $\mathrm{Set}$, a \emph{$\mathcal{C}'$-valued presheaf} on $\mathcal{C}$ is a contravariant functor $\pazocal{F} : \mathcal{C}\rightarrow \mathcal{C}'$. We denote the image of a morphism $\varphi: V \rightarrow U$ under $\pazocal{F}$ by $\varphi_{UV}$.
\end{definition}
\begin{remark}
    We will mainly be interested in the case of $\mathcal{C}$ being obtained from a topological space: Consider a topological space $(X,\tau_X)$. We consider the category $\pazocal{T}(X)$ induced by the preorder on $\tau_X$. This will be called a \emph{presheaf on $X$}. Moreover we will mainly be interested in presheaves valued in algebraic categories such as $\mathrm{Group},\mathrm{AbGroup},\mathrm{Ring}$, etc.\\  
\end{remark}
\begin{example}
    Let $X$ be a variety. Then $$\Gamma: (\tau_X,\subset) \rightarrow \mathrm{FinAlg}_K, (U, W\subset V)\mapsto (\Gamma(U), \widetilde{\varphi}: \Gamma(V)\rightarrow \Gamma(W), f \mapsto \left.f\right|_{W})$$
    defines a presheaf on $\pazocal{T}(X)$ respect to the Zariski topology. 
\end{example}
\begin{definition}\label{RestrictionInImageOfPresheaf}
    For objects $U,V$ in $\pazocal{C}$ and a morphism $\varphi: V\rightarrow U$, for an  $s\in \pazocal{F}(U)$, we define \emph{restriction of $s$ to $V$} to be $$\left. s\right|_{V}:= \varphi_{UV}.$$
\end{definition}
\subsubsection{Sheaves}
\begin{definition}
    Consider a topological space $X$. Let $\pazocal{F}$ be a presheaf on a category $\pazocal{T}(X)$. $\pazocal{F}$ is called a \emph{sheaf on $X$} if moreover, 
    \begin{enumerate}
        \item For every open $U\subset X$ and every open cover $\{U_i\}$ of $U$ and every $\phi,\varphi\in \pazocal{F}(U)$, if $\left.\varphi\right|_{U_i}= \left.\phi\right|_{U_i}$ for every $i$, then $\varphi=\phi$.
        \item For every open $U\subset X$ and every open covering $\{U_i\}$ and for every collection of elements (functions) 
        $$\left\{s_i\in \pazocal{F}(U_i): \left.s_i\right|_{U_i\cap U_j}=\left. s_j\right|_{U_i\cap U_j} \text{ for every }j\right\}_{i}$$
        there is an element $s\in \pazocal{F}(U)$ such that $\left.s\right|_{U_i}=s_i$ for each $i$.   
    \end{enumerate}
    A sheaf valued in a subcategory of $\mathrm{Set}$ is defined in a similar way for sheaves to how it was defined for presheaves. 
\end{definition}
\begin{remark}
    By condition 1. an element $s\in \pazocal{F}(U)$ obtained as described in 2. is unique.
\end{remark}

\begin{lemma}
    Consider a topological space $X$ and a presheaf $\pazocal{F}$ on $X$ valued in the category of abelian groups that satisfies the second condition of being a sheaf. Then $\pazocal{F}$ is a sheaf on $X$ if and only if for every open $U\subset X$ every open covering $\{U_i\}$ and every $s\in \pazocal{F}(U)$, if $\left.s\right|_{U_i}=0$ for every $i$, then $s=0$.   
\end{lemma}
\begin{proof}
    "$\implies$": If $\pazocal{F}$ is a sheaf on $X$, then since $\left. s\right|_{U_i}=0=\left.0\right|_{0}$ for every $i$, then $s=0$.\\
    "$\impliedby$": If $\left. s\right|_{U_i} = \left. t\right|_{U_i}$ for every $i$, hence 
    $$0=\left. s\right|_{U_i} - \left. t\right|_{U_i} = \left. s-t\right|_{U_i}$$
    for every $i$, which by assumption means $s-t=0$. 
\end{proof}
\begin{example}
    The presheaf $\Gamma$ on a variety $X$ seen as a space equipped with the Zariski topology is a sheaf. Consider an subvariety $U\subset X$ and open covering $\{U_i\}$ of $U$ and suppose there is a regular function $f\in \Gamma(U)$ such that $\left. f\right|_{U_i}=0$ for every $i$. Viewing $f$ as a function $U$ it follows that given a point $x\in U$ since $x\in U_i$ for some $i$, 
    $$f(x)=\left.f\right|_{U_i}(x)= 0 \implies f = 0.$$
    Consider an open covering, $\{U_i\}$ of a subvariety $U\subset X$ and a collection of regular functions 
    $$\left\{f_i\in \Gamma(U_i): \left.f_i\right|_{U_i\cap U_j}= \left. f_j\right|_{U_i\cap U_j} \right\}_i,$$
    then the function 
    \begin{gather*}
        f : U \rightarrow K \\
         x\mapsto f_i(x) \quad \text{if } x\in U_i
    \end{gather*} 
    is a regular function on $U$ such that $\left. f\right|_{U_i} = f_i$. Indeed, restriction in the sense of Definition~\ref{RestrictionInImageOfPresheaf} is in this instance literally restriction in the usual sence, so the definition of $f$ is indenpendent of the choice of $U_i$.
\end{example}
Recall the following definition
Recall from \ref{DirectLimits} the definition of a direct limit. We shall construct the direct limit in the category of groups
\begin{definition}
    Let $G_\bullet: (I,\leq) \rightarrow \mathrm{grp}$ be a direct system and the associated collections of objects and morphisms $(\{G_i\},\{f_{ij}\})$. Given elements $(x_i,i),(x_j,j)$ in  
    $$
        \bigsqcup_{i\in I} G_i
    $$
    we define an equivalence relation $\sim$, by postulating $x_i\sim x_j$ if there exists $k\in I$ with $i,j\leq k$ and 
    $$
        f_{ik}(x_i) = f_{jk}(x_j).
    $$
    The \emph{direct limit of $G_\bullet$} is defined to be the set 
    $$
        \varinjlim G_i := \bigcup_{i\in I} G_i/\sim.
    $$
    Given a pair of elements $[x_i],[x_j]\in \varinjlim G_i$ we define 
    $$
        [x_i][x_j] := [f_{ik}(x_i)f_{jk}(x_j)]
    $$
    where $k\in I$ is an element such that $i,j\leq k$. There is a canonical natural transformation $\phi: G_\bullet \Rightarrow \varinjlim G_i$ given by
    $$\{G_i \rightarrow \varinjlim G_i, x_i \mapsto [x_i]\}$$
\end{definition}
\begin{remark}
    By functioriality the definition of the binary operation of the direct limit of $\{G_i\}$ is independent of the choice of $k$. Since for $i\leq l$, 
    $$
        f_{il}(x_i) = f_{ll}f_{il}(x_i) \implies [x_i]=[f_{il}(x_i)].
    $$
    This means that for every $h\geq k$, 
    $$
        [f_{ik}(x_i)f_{jk}(x_j)] = [f_{kh}(f_{ik}(x_i)f_{jk}(x_j))] =[(f_{kh}f_{ik})(x_i)(f_{kh}f_{ik})(x_j)]=[f_{ih}(x_i)f_{jh}(x_j)].
    $$
\end{remark}
\begin{lemma}
    Keeping the notation from the prior definition, the set $\varinjlim G_i$ with the described binary operation is a group. When the direct system is valued in $\mathrm{ab}$, the direct limit is an abelian group
\end{lemma}
\begin{proof}
    first we check that the operation is well defined. Let $([x_i],[x_j]),([x_p],[x_q])$ in the direct limit of $\{G_i\}$. Then $f_{ik}(x_i)=f_{pk}(x_p)$ and $f_{jh}(x_j)=f_{qh}(x_q)$ for suitable $k,h\in I$ with $i,p\leq k$ and $j,q\leq h$. Pick an $l\in I$ with $h,k\leq l$. Then 
    $$
        [x_i][x_j]=[f_{il}(x_i)f_{jl}(x_j)]=[f_{pl}(x_p)f_{ql}(x_q)] = [x_p][x_q].
    $$
    One readily verifies that this operation is associative.
    Note that since each $f_{ij}$ is a group homomorphism, the identity of each $G_i$ is in the same equivalence class and one sees that $e:=[e_i]$ is neutral with respect to the binary operation in $\varinjlim G_i$. Lastly defining $[x_i]^{-1} = [x_i^{-1}]$, one readily verifies that this is independent of the choice of representative and that it is inverse element of $[x_i]$.
\end{proof}
\begin{lemma}
    Consider a direct system $(\{G_i\},\{f_{ij}\})$ of groups. Then $\varinjlim G_i$ with $\phi: G_\bullet \Rightarrow \varinjlim G_i$ is the direct limit in the category theoretic sense.
\end{lemma}
\begin{proof}
    Let a cocone $(G,\lambda)$ of the direct system be given. We define 
    \begin{gather*}
        u : \varinjlim G_k \rightarrow G\\
        [x_i] \mapsto \lambda_i(x_i)
    \end{gather*}
    This is well defined by the naturality of $\{\lambda_i\}$. Let $i,j\in I$ with $i\leq j$ be given. Clearly, $u$ is the unique homomorphism making 
    $$
        \begin{tikzcd}
            G_i \arrow[rr,"f_{ij}"] \arrow[rd, "\phi_i"]\arrow[rdd, "\lambda_i",bend right = 20] && G_j \arrow[ld,"\phi_j"]\arrow[ldd,"\lambda_j",bend left = 20]\\
            & \varinjlim G_k \arrow[d," u"]\\
            & G
        \end{tikzcd}
    $$    
    commute. We thus conclude that our construction is indeed the direct limit in the categorical sense. 
\end{proof}
\begin{definition}
    Consider a topological space $X$ and a presheaf $\pazocal{F}$ on $X$ valued in $\mathrm{ab}$. Let $P\in X$. We define the \emph{stalk of $\pazocal{F}$ at $P$} to be  
    $$
        \pazocal{F}_P := \varinjlim_{U\ni P} \pazocal{F}\in \mathrm{ab}. 
    $$
    given an element $s\in \pazocal{F}(U)$ we call $[s]_P := [s]$ a \emph{germ} of $f$ at $P$. 
\end{definition}
\begin{remark}
    Note that by construction $(U,s),(V,t)\in \pazocal{F}_P$ are equal if and only if there is some open neighborhood of $P$,  $W\subset U\cap V$ with 
    $$\left. s\right|_{W} = \left. t\right|_W.$$
    There is a natural transformation 
    \begin{gather*}
        \phi : \pazocal{F}(U) \Rightarrow \pazocal{F}_p\\
        s\mapsto (U,s)
    \end{gather*}
\end{remark}
\begin{definition}
    Given a category $\pazocal{C}$ \emph{a morphism of presheaves} is just a morphism in the functor category $\mathrm{Set}^{\pazocal{C}\op}$, i.e. a morphism $\Phi: \pazocal{F} \rightarrow \pazocal{G}$ of parallel presheaves on $\pazocal{C}$ is just a natural transformation $\Phi : \pazocal{F}\Rightarrow \pazocal{G}$.\\
    An isomorphism of presheaves is therefor just a natural isomorphism of presheaves. \\
    \emph{A morphism of sheaves} is just a morphism of presheaves in the category of sheaves, $\mathrm{Sh}(X)$, which is a subcategory of $\mathrm{Set}^{\pazocal{T}(X)\op}$.   
\end{definition}
\begin{definition}
    Consider a parallel pair of presheaves $\pazocal{F},\pazocal{G}: X\rightarrow \mathrm{ab}$ and fix a point $P\in X$. For a morphism of presheaves $\Phi : \pazocal{F}\Rightarrow \pazocal{G}$, there is an induced morphism of stalks at $P$ given by
    \begin{gather*}
        \Phi_P : \pazocal{F}_P \rightarrow \pazocal{G}_P\\
        (U,s)\mapsto (U,\Phi_U(s))
    \end{gather*}
\end{definition}
\begin{remark}
    Alternatively, we can describe the above map as taking a germ $[s]_P$ to $[\Phi_U(s)]_P$ where $U$ is any open neighborhood of $P$. 
\end{remark}
\begin{proposition}
    Consider a parallel pair of sheaves $\pazocal{F},\pazocal{G}: X\rightarrow \mathrm{ab}$ and morphism of sheaves $\Phi: \pazocal{F}\Rightarrow \pazocal{G}$. Then $\Phi$ is an isomorphism if and only if $\Phi_P:\pazocal{F}_P\rightarrow \pazocal{G}_P$ is an isomorphism for each $P\in X$.  
\end{proposition}
\begin{proof}    
\end{proof}

\begin{definition}
     Consider a parallel pair of presheaves $\pazocal{F},\pazocal{G}: \pazocal{C}\rightarrow \mathrm{ab}$ and morphism of sheaves $\Phi: \pazocal{F}\Rightarrow \pazocal{G}$. 
    \begin{itemize}
        \item We define \emph{the presheaf kernel of $\Phi$} to be the presheaf 
    \begin{gather*}
        \ker \ \Phi: \pazocal{C} \rightarrow \mathrm{ab}\\
        U \mapsto \ker\ \Phi_U\\
        U\rightarrow V \mapsto \left.\varphi_{UV}\right|_{\ker\ \Phi_V} : \ker \ \Phi_V \rightarrow \ker \ \Phi_U
    \end{gather*}
    \item  We define \emph{the presheaf cokernel of $\Phi$} to be the presheaf 
    \begin{gather*}
        \mathrm{pscoker} \  \Phi: \pazocal{C}\rightarrow \mathrm{ab}\\
        U \mapsto \coker\ \Phi_U\\
        U\rightarrow V \mapsto \coker\ \Phi_V \rightarrow \coker\ \Phi_U, x+ \im \ \Phi_V \mapsto \pi_{UV}(x) + \im\ \Phi_U  
    \end{gather*}
    \item We define \emph{the presheaf image of $\Phi$} to be the presheaf
    \begin{gather*}
        \mathrm{psim}\ \Phi : \pazocal{C}\rightarrow \mathrm{ab}\\
        U\mapsto \im \ \Phi_U\\
        U\rightarrow V\mapsto \left.\pi_{UV}\right|_{\im \ \Phi_V} \im \ \Phi_V\rightarrow \im \ \Phi_U, x\mapsto \pi_{UV}(x) 
    \end{gather*}
    \end{itemize}
\end{definition}
\begin{remark}
    Unsurprisingly, the welldefinedness of the above presheaves are ensured by naturality. Functorialty follows from the functioriality of $\pazocal{F}$ and $\pazocal{G}$.
\end{remark}
\begin{lemma}
    The presheaf kernel of a morphism of presheaves is a sheaf.
\end{lemma}
\begin{proof}
    
\end{proof}
\begin{lemma}
    Consider a presheaf $\pazocal{F}:X\rightarrow \mathrm{ab}$ on topological space $X$. There is a sheaf $\pazocal{F}^{+}: X\rightarrow \mathrm{ab}$ and morphism of presheaves $\Theta : \pazocal{F}\Rightarrow\pazocal{F}^{+}$ such that for any sheaf $\pazocal{G}:X\rightarrow \mathrm{ab}$ and any morphism of presheaves $\Phi : \pazocal{F} \Rightarrow \pazocal{G}$ there is a unique morphism of sheaves $\Psi : \pazocal{F}^{+}\Rightarrow \pazocal{G}$ such that $\Phi = \Psi \Theta$. Furthermore $(\pazocal{F}^{+},\Theta)$ is unique up to unique isomorphism. 
\end{lemma}
\begin{proof}
    We construct a presheaf
    \begin{gather*}
        X\rightarrow \mathrm{ab}
    \end{gather*}
    Given an open subset $U$ in $X$, we define $\pazocal{F}^{+}(U)$ to be the group of elements $([s]_P)$ in 
    $$\prod_{P\in U} \pazocal{F}_P$$
    such that for each $P\in U$ there is an open neighborhood of $P$, $W\subset U$ with an element $t\in \pazocal{F}(W)$ such that for each $Q\in V$ the germ $[t]_Q\in \pazocal{F}_Q$ of $t$ at $Q$ satisfies
    $$([s]_P)(Q) = [t]_Q.$$
    Given $U\subset V$ we define $\varphi_UV : \pazocal{F}^{+}(V)\rightarrow \pazocal{F}^{+}(U)$ to be given by restriction. It thus readily follows that $\pazocal{F}^{+}$ is a sheaf. We have a natural transformation
    \begin{gather*}
        \Theta : \pazocal{F}\Rightarrow \pazocal{F}^{+}\\
        \{\Theta_U : \pazocal{F}(U)\rightarrow \pazocal{F}^{+}(U), s \mapsto ([s]_P)\}.
    \end{gather*}
    Indeed, $(U,s)$ is a pair witnessing the fact that $[s]_P\in \pazocal{F}^{+}$, so this is well-defined. Let a natural transformation of presheaves $\Phi : \pazocal{F}\Rightarrow \pazocal{G}$ be given. We define a natural transformation of sheaves 
    \begin{gather*}
        \Psi: \pazocal{F}^{+} \Rightarrow \pazocal{G}
    \end{gather*}
    defined by the collection of morphisms  
    $$
        \left.\left\{ \Psi_U: \pazocal{F}^{+}(U) \rightarrow \pazocal{G}(U), ([s]_P)\mapsto \Psi_U(s) \ \right| \   U\subset X \text{ open}\right\}
    $$
    This is well-defined since $\pazocal{G} \cong \pazocal{G}^{+}$ or in other words since $\pazocal{G}(U)\simeq \pazocal{G}^{+}(U)$. $\Psi$ is the unique morphism of sheaves making the diagram
    $$
        \begin{tikzcd}
            \pazocal{F} \arrow[rd,Rightarrow, "\Phi"] \arrow[d,"\Theta",Rightarrow]\\
            \pazocal{F}^{+} \arrow[r, dashrightarrow] & \pazocal{G}
        \end{tikzcd}
    $$
    commute. Note that $(\pazocal{F}^{+},\Theta)$ is thus the coequalizer two copies of the identity transformation of $\pazocal{F}$ (cf. Example~\ref{EqualisersAndCoequalisers}) which means it is unique up to unique isomorphism.
\end{proof}
\begin{remark}
    We call $\pazocal{F}^{+}$ \emph{the sheaf associated with $\pazocal{F}$}
\end{remark}
\begin{definition}
    A \emph{subsheaf} of a sheaf $\pazocal{F}$ is a sheaf $\pazocal{F}'$ such that for every open set $U$ in $X$, $\pazocal{F}'(U)\leq \pazocal{F}(U)$ and, letting $\varphi_{UV}:\pazocal{F}(V)\rightarrow \pazocal{F}(U)$ denote the image of $U\subset V$ under $\pazocal{F}$, the image of $U\subset V$ under $\pazocal{F}'$ is the restriction of $\varphi_{UV}$ to $\pazocal{F}(V)$.
\end{definition}
\begin{remark}
    Note that given $(U,s)\in \pazocal{F}'_P$, we have that $s\in \pazocal{F}'(U)\subset \pazocal{F}(U)$, hence $(U,s)\in \pazocal{F}_P$. 
\end{remark}
\begin{example}
    The presheaf kernel of morphism of sheaves $\Phi:\pazocal{F}\Rightarrow \pazocal{G}$ is sheaf called the \emph{sheaf kernel}. By construction $(\ker \ \Phi)(U) = \ker \ \Phi_U \leq \pazocal{F}(U)$ and 
    $$(\ker \ \Phi)(U\subset V) = \left. \varphi_{UV}\right|_{\ker\ \Phi_U},$$
    hence $\ker \ \Phi$ is a subsheaf of $\pazocal{F}$. 
\end{example}
\begin{definition}
    A morphism of sheaves $\Phi:\pazocal{F}\Rightarrow \pazocal{G}$ is \emph{injective} if $\ker \ \Phi=0$, i.e. the sheaf that takes every open subset of $X$ to the trivial group.
\end{definition}
\begin{remark}
    $\Phi$ being injective is equivalent to $\Phi_U$ being injective for each open set $U$. 
\end{remark}
\begin{definition}
    For a morphism of sheaves $\Phi: \pazocal{F}\Rightarrow \pazocal{G}$, we define the \emph{image of $\Phi$} to be $\im \ \Phi:= (\mathrm{psim}\ \Phi)^{+}$
\end{definition}
\begin{proposition}
    Given a morphism of sheaves $\Phi:\pazocal{F}\Rightarrow \pazocal{G}$, the canonical morphism $\im\ \Phi\Rightarrow \pazocal{G}$ is injective, hence it can be indentified with a subsheaf of $\pazocal{G}$. 
\end{proposition}
\begin{proof}
    
\end{proof}
\begin{definition}
    A morphism of sheaves $\Phi:\pazocal{F}\Rightarrow \pazocal{G}$ is \emph{surjective} if $\im\ \Phi = \pazocal{G}$.
\end{definition}
\begin{definition}
    A sequence 
    $$
        \begin{tikzcd}
            \dots \arrow[r, Rightarrow, "\Phi^{i-1}"] & \pazocal{F}^{i-1} \arrow[r, Rightarrow, "\Phi^i"] & \pazocal{F}^i \arrow[r, Rightarrow, "\Phi^{i+1}"] & \pazocal{F}^{i+1} \arrow[r, Rightarrow] & \dots
        \end{tikzcd}
    $$
    is \emph{exact}, if $\ker\ \Phi^i = \im \ \Phi^{i-1}$ for each $i \in \Z$. 
\end{definition}
\begin{definition}
    Consider a sheaf $\pazocal{F}$ and subsheaf $\pazocal{F}'\subset \pazocal{F}$. We define the \emph{quotient sheaf $\pazocal{F}/\pazocal{F}'$} to be the sheaf associated with 
    \begin{gather*}
        X\rightarrow \mathrm{ab}\\
        U\mapsto \pazocal{F}(U)/\pazocal{F}'(U)\\
        U\subset V \mapsto \pazocal{F}(V)/\pazocal{F}'(V) \rightarrow \pazocal{F}(U)/\pazocal{F}'(U), s + \pazocal{F}'(V) \mapsto \left. s\right|_{U}+\pazocal{F}'(U)
    \end{gather*}
\end{definition}
\begin{remark}
    Fix a point $P\in X$ and consider $(U,s)\in (\pazocal{F}/\pazocal{F}')_P$. Note that then $s\in \pazocal{F}(U)/\pazocal{F}'(U)$, hence $(U,s)\in \pazocal{F}_P/\pazocal{F}'_P$.
\end{remark}
With the above in mind we can make the following definition
\begin{definition}
    For a morphism of sheaves $\Phi : \pazocal{F}\Rightarrow \pazocal{G}$, we define the \emph{cokernel of $\Phi$} to be $\coker\ \Phi := (\mathrm{pscoker}\ \Phi)^{+}$.
\end{definition}
\begin{definition}
    For a continuous map $f : X\rightarrow Y$ and a sheaf $\pazocal{F}$ on $X$, we define the \emph{direct image sheaf}, $f_\star\pazocal{F}$, on $Y$, to be the sheaf
    \begin{gather*}
        Y \rightarrow \mathrm{ab}\\
        U \mapsto \pazocal{F}(f^{-1}(U))\\
        U\subset V \mapsto \varphi_{f^{-1}(U)f^{-1}(V)}
    \end{gather*}
\end{definition}
\begin{remark}
    We check that this indeed a sheaf {\Large Check!}
\end{remark}
\begin{definition}
    For a continuous map $f : X\rightarrow Y$ and a sheaf $\pazocal{F}$ on $Y$, we define the \emph{inverse image sheaf}, $f^{-1}\pazocal{G}$ on $X$ to be the sheaf associated with the presheaf
    \begin{gather*}
        X\rightarrow \mathrm{ab}\\
        U\mapsto \varinjlim_{V\supset f(U)}\pazocal{G}(V)\\
        U\subset V\mapsto \varphi_{\lim_{W\supset f(U)}\pazocal{G}(W)\lim_{W\supset f(V)}\pazocal{G}(W)}
    \end{gather*}
\end{definition}
\begin{definition}
    Consider a topological space $X$, a subspace $Z\subset X$ and a sheaf $\pazocal{F}$ on $X$. Let $\iota$ denote the inclusion map $Z\hookrightarrow X$. We define \emph{the restriction of $\pazocal{F}$ to $Z$} to be the sheaf $\left.\pazocal{F}\right|_{Z}:= \iota^{-1}\pazocal{F}$.
\end{definition}
\begin{remark}
    Fix a point $P\in Z$. Let $(U,s)\in \left(\left. \pazocal{F}\right|_Z\right)_P$... {\Large Do!}
\end{remark}
\subsection{Schemes}
We adopt the convention that all rings are commutative.
\subsubsection{Affine Schemes}
\begin{definition}
    For a ring $R$, we define \emph{the spectrum of $R$} to be the set
    $$
        \Spec\ R := \{ I \subset R : I \text{ is a prime ideal}\}
    $$
    For an ideal $I\subset R$, we define 
    $$
        V(I) := \{ J\in \Spec \ R : I\subset J\}
    $$
\end{definition}
\begin{lemma}
    If $I\subset J\subset R$ are ideals, then $V(I)\supset V(J)$.
\end{lemma}
\begin{proof}
    This is trivial. 
\end{proof}
\begin{lemma}
    For ideals $I,J\subset R$
    $$V(IJ) = V(I)\cup V(J).$$
\end{lemma}
\begin{proof}
    Consider a prime ideal $\mathfrak{p}\in \Spec \ R$ containing $IJ$. Then given $ab\in IJ$ with $a\in I$ and $b\in J$ we have that $a \in \mathfrak{p}$ or $b\in \mathfrak{p}$, hence $\mathfrak{p}\in V(I)\cup V(J)$. The converse inclusion follows from $I,J\supset IJ$ by the prior lemma. 
\end{proof}
\begin{lemma}
    For a family of ideals $\{I_\mu\}$ in $R$, 
    $$V\left(\sum_\mu I_\mu\right) = \bigcap_\mu V(I_\mu).$$ 
\end{lemma}
\begin{proof}
    Again one inclusion follows from $I_\nu\subset \sum_\mu I_\mu$. Suppose conversely that $\mathfrak{P}\in \Spec \ R$ is given such that it contains every $I_\mu$, then since ideals are closed under addition it contains $\sum_\mu I_\mu$.  
\end{proof}
\begin{proposition}
    For a ring $R$, the family of sets 
    $$
        \{V(I) : I \text{ is an ideal in } R\}
    $$
    are the closed set in a topology on $\Spec \ R$. 
\end{proposition}
\begin{proof}
    Indeed, note that 
    $$\bigcap_{I\subset R} V(I) = V\left(\sum_{I\subset R} I\right)= V(R) = \emptyset.$$
    and that $\Spec\ R = V(0)$. The two prior lemmas show that this family is closed under countable union and intersection over arbitrary index sets. 
\end{proof}
\begin{remark}
    The topology in question is unsurprisingly called the \emph{Zariski topology on $\Spec \ R$}. For an algebraically closed field $K$ and an affine variety $V\subset \A^n$, the points of $V$ correspond to the maximal ideals of $\Gamma(V)$. In this way we can identify $V$ with the subspace of maximal ideals of $\Gamma(V)$ in $\Spec \ \Gamma(V)$. In this sense $\Spec \ \Gamma(V)$ is a refinement of the notion of point in a variety. Namely, \emph{point} in $V$ have by definition come to mean the \emph{subvariety} of $V$, when we take the view that our vantage point lies in $\Spec\ \Gamma(V)$ when studying $V$.
\end{remark}
\begin{lemma}
    If $I,J\subset R$ are ideals, then $V(I)\subset V(J)$ if and only if $\rad(I)\supset \rad(J)$.
\end{lemma}
\begin{proof}
    Note that $V(I)\subset V(J)$ if and only if every prime ideal that contains $I$ also contains $J$ which again is equivalent to 
    $$
        \bigcap_{\mathfrak{p}\supset I \text{ prime }} \mathfrak{p} \supset \bigcap_{\mathfrak{p}\supset J \text{ prime }} \mathfrak{p}, 
    $$
    which by lemma \ref{RadicalOfIdealIsIntersectionOfAllPrimeIdealsContainingIt} is equivalent to 
    $$
        \rad(I)\supset \rad(J).
    $$
\end{proof}
Given a ring $R$ and prime ideal $\mathfrak{p}$ in $R$. We denote the localization of $R$ with respect to $\mathfrak{p}$ by $R_\mathfrak{p}$.
\begin{definition}
    Given a ring $R$, we define a presheaf on $\Spec \ R$ by, 
    \begin{gather*}
        \pazocal{O}:(\Spec\ R, \tau_{\Spec\ R})\op\rightarrow \mathrm{Ring} 
    \end{gather*}
    that takes an open subset $U$ of $\Spec\ R$ to the subring of $\prod_{\mathfrak{p}\in U} R_\mathfrak{p}$, 
    $$
        \pazocal{O}(U) := \left\{ s\in \prod_{\mathfrak{p}\in U}  R_\mathfrak{p} : \forall\mathfrak{p}\in U \exists  V \text{ op. ngh. } \text{ of } \mathfrak{p} \text{ s.t. } \left.s\right|_V = \frac{a}{f}   \text{ w/ } f\notin \mathfrak{q} \text{ for each } \mathfrak{q}\in V \right\}.
    $$  
    Moreover, $V\subset U$ is mapped to the restriction map $\pazocal{O}(U)\rightarrow \pazocal{O}(V), s\mapsto \left. s\right|_V$.
\end{definition}
\begin{remark}
    Clearly this presheaf is a sheaf, since the elements of $\pazocal{O}(U)$ are functions and restriction is just set function restriction in the same we saw in the example discussing the presheaf $\Gamma$. 
\end{remark}
\begin{definition}
    For $f\in R$, we define 
    $$
        D(f) := (\Spec \ R)\setminus V(\langle f\rangle)
    $$
\end{definition}
\begin{lemma}
    For a ring $R$,
    $$
        \{D(f)\subset \Spec\ R : f\in A\}
    $$
    forms a basis of the Zariski topology on $\Spec\ R$.
\end{lemma}
\begin{proof}
    Indeed, for $\mathfrak{p}\notin V(I)$, there is an $f\in I$ not in $\mathfrak{p}$, hence $\mathfrak{p}\notin V(\langle f\rangle)$, meaning $\mathfrak{p}\in D(f)$. Then $V(I)\cap D(f) = \emptyset$. This means that every point in an open subset $U$ in $\Spec \ R$ has an open neighborhood contained in $U$. It follows that the collection in question forms an open basis for the Zariski topology. 
\end{proof}
\begin{lemma}\label{FiniteNumberOfRepresentationsOfSection}
    Consider a ring $R$, an element $f\in R$ and a section $s\in \pazocal{O}(D(f))$. There are $a_1,\dots,a_m,h_1,\dots,h_m\in R$ such that 
    $$
        D(f) = \bigcup_1^m D(h_i)
    $$
    and 
    $$
        s(\mathfrak{p}) = \frac{a_i}{h_i}\in R_\mathfrak{p}
    $$
    for every $\mathfrak{p}\in D(h_i)$ for each $i$. 
\end{lemma}
\begin{proof}
    First of all, there are $\{\lambda_\alpha\}$ in $R$ such that 
    $$
        D(f) = \bigcup_\alpha D(\lambda_\alpha)
    $$
    and $s(\mathfrak{p})=\frac{a_\alpha'}{g_\alpha}$ for some $a_\alpha',g_\alpha \in R$ with $g_\alpha\notin \mathfrak{p}$ for each $\mathfrak{p}\in D(\lambda_\alpha)$. Since $D(\lambda_\alpha)\subset D(g_\alpha)$, it follows that $\rad(\langle \lambda_\alpha \rangle)\subset \rad(\langle g_\alpha\rangle)$, hence for some $k_\alpha \geq 1$, 
    $$
        \lambda_\alpha^{k_\alpha} = l_\alpha g_\alpha \implies \frac{l_\alpha a_\alpha'}{\lambda_\alpha^{k_\alpha}} = \frac{a_\alpha'}{g_\alpha}.
    $$
    Setting $h_\alpha := \lambda_\alpha^{k_\alpha}$ and $a_\alpha := l_\alpha a_\alpha'$. We get, upon noting that $D\left(h_\alpha^{k_\alpha}\right) = D(\lambda_\alpha)$, a cover $\{h_\alpha\}$ of $D(f)$ with 
    $$
        s(\mathfrak{p})= \frac{a_\alpha}{h_\alpha}
    $$
    with $h_\alpha\notin \mathfrak{p}$.
    Note that 
    $$
        D(f) \subset \bigcup_\alpha D(h_\alpha) \iff V(\langle f\rangle) \supset \bigcap_\alpha D(h_\alpha) \iff \rad(\langle f\rangle)\subset \rad\left(\sum_\alpha \langle h_\alpha\rangle\right).
    $$
    The last of these statements is equivalent to $f^n = \sum_1^m b_ih_i$ for some $n\geq 1$, $b_1,\dots,b_m\in R$ and $\{h_1,\dots,h_m\}\subset \{h_\alpha\}$. So it follows that $D(f) = \bigcup_1^m D(h_i)$.
\end{proof}
\begin{lemma}\label{StalkCorrespondToPrimeLocalizationSheafOnBasisSetCorrespondToLocalization}
    Consider a ring $R$. Then 
    \begin{enumerate}
        \item For every point $\mathfrak{p}\in \Spec\ R$
        $$
            \pazocal{O}_\mathfrak{p} \simeq R_\mathfrak{p}.
        $$
        \item For any $f\in R$,
        $$
            \pazocal{O}(D(f)) \simeq R_f.
        $$
        \item In particular,
        $$
            \Gamma(\Spec\ R,\pazocal{O}):= \pazocal{O}(\Spec\ R) = \pazocal{O}(D(1)) \simeq R_1 = R.
        $$
    \end{enumerate}    
\end{lemma}
\begin{proof}
    1. Consider the ring map
    \begin{gather*}
        \sigma:\pazocal{O}_\mathfrak{p} \rightarrow R_\mathfrak{p}\\
        s\mapsto s(\mathfrak{p})
    \end{gather*}
    To check surjectivity, let $\frac{a}{f}\in R_\mathfrak{p}$ be given. By definition $f\notin \mathfrak{p}$, hence $\mathfrak{p}\not\supset \langle f\rangle$. We thus get that $D(f)$ is an open neighborhood of $\mathfrak{p}$. Let $\frac{a}{f}: D(f)\rightarrow \prod_{\mathfrak{q}\in D(f)} R_\mathfrak{q}$ denote the constant function on $D(f)$ taking $\mathfrak{q}$ to $\frac{a}{f}$. Then this is an element of $\pazocal{O}_\mathfrak{p}$ and 
    $$
        \sigma\left(\frac{a}{f}\right) = \frac{a}{f}.
    $$
    To check injectivity, consider $s,t\in \pazocal{O}_\mathfrak{p}$ with $s(\mathfrak{p})=r(\mathfrak{p})$. On a sufficiently small neighborhood $U$ of $\mathfrak{p}$, we have that $\left. s\right|_U = \frac{a}{f}\in R_\mathfrak{q}$ and $\left. t\right|_U = \frac{b}{g}\in R_\mathfrak{q}$ for each $q\in U$. There is some $h\in R\setminus \mathfrak{p}$ such that $h(ag-bf)=0$, hence on $D(f)\cap D(g)\cap D(h)$, $s$ and $t$ agree. This implies $s=t$. We conclude that $\sigma$ is an isomorphism of rings.\\
    2. We define a homomorphism 
    \begin{gather*}
        \tau: R_f \rightarrow \pazocal{O}_P
    \end{gather*} 
    That takes $\frac{a}{f^n}\in R_f$ to the function $s\in \prod_{\mathfrak{p}\in D(f)}$ that takes $\mathfrak{p}\in D(f)$ to $\frac{a}{f^n}$, which is well-defined since $\mathfrak{p}\not\supset  \langle f^n\rangle $ for every $n\geq 0$. We claim that this is an isomorphism.\\
    To show injectivity, suppose 
    $$
        \tau\left(\frac{a}{f^n}\right) = \tau\left(\frac{b}{f^m} \right)
    $$
    for a pair $\frac{a}{f^n},\frac{b}{f^m}\in R_f$. Then for every $\mathfrak{p}\in D(f)$  
    $$
        h_\mathfrak{p}\left(af^m-bf^n\right) = 0
    $$
    for some $h_\mathfrak{p}\in R\setminus \mathfrak{p}$. Set $\mathfrak{a}:= \mathrm{Ann}(af^m-bf^n)$. Note then that $\mathfrak{p}\not\supset \mathfrak{a}$, since $h_\mathfrak{p}\in \mathfrak{a}$. We get that $V(\mathfrak{a})\cap D(f)=\emptyset$, hence $V(\mathfrak{a})\subset V(\langle f\rangle)$, which is equivalent to $\langle f\rangle \subset \rad(\mathfrak{a})$. Then $f^l(af^m-bf^n)=0 $ for some $l\geq0$. It thus follows that $\frac{a}{f^n}=\frac{b}{f^m}$ in $R_f$.\\
    To show surjectivity, note first that $D(f)$ has a finite cover $\{D(h_i)\}_1^m$ with $s(\mathfrak{p})=\frac{a_i}{h_i}\in R_\mathfrak{p}$ for some $a_i\in R$ for each $\mathfrak{p}\in D(h_i)$ for each $i$. Consider a pair of indeces $i$ and $j$ and note that under 
    $$
        \tau' : R_{h_ih_j} \rightarrow \pazocal{O}(D(h_ih_j))=\pazocal{O}(D(h_i)\cap D(h_j)), 
    $$
    which takes a fraction to its associated constant section on $D(h_ih_j)$, $\frac{a_i}{h_i}$ and $\frac{a_j}{h_j}$ agree, then $\frac{a_i}{h_i}=\frac{a_j}{h_j}$ in $R_{h_ih_j}$. Then for some $k\geq 0$
    $$
        \left(h_ih_j\right)^k(a_ih_j-a_jh_i)=0 \iff h_j^{k+1}\left(h_i^ka_i\right)= h_i^{k+1}\left(h_j^ka_j\right).
    $$
    Note that $D(f)=\bigcup_1^m D(h_i^{k+1})$ and $s(\mathfrak{p})=\frac{a_i}{h_i}=\frac{h_i^ka_i}{h_i^{k+1}}$ for each $\mathfrak{p}\in D(h_i)=D(h_i^{k+1})$. For the sake of simplifying notation set $\lambda_i := h_i^{k+1}$ and $c_i := h_i^ka_i$. With this notation we find $\lambda_jc_i = \lambda_ic_j$ for each $i$ and $j$. Since $f\in \rad\left(\sum_1^m \lambda_i\right)$, there is an $n\geq 1$ and $b_1,\dots,b_m\in R$ with 
    $$
        f^n = \sum_1^m b_i\lambda_i. 
    $$ 
    Set 
    $$
        a:= \sum_1^m b_ic_i.
    $$
    Then we find  
    $$
        \lambda_j a= \sum_1^m \lambda_j b_i c_i = c_j\sum_1^m \lambda_ib_i = c_jf
    $$
    Then on each $D(h_i)$ for each $\mathfrak{p}\in D(h_i)$,
    $$
        \tau\left(\frac{a}{f^n}\right)(\mathfrak{p})=\frac{c_i}{\lambda_i} = s(\mathfrak{p}) \implies \tau\left(\frac{a}{f^n}\right) = s,
    $$
    hence $\tau$ is also surjective. We thus conclude that $\tau$ is a ring isomorphism.\\
    3. Follows immediately from 2.
\end{proof}
\begin{definition}
    A \emph{ringed space} is a topological space $X$ together with a sheaf 
    $$
        \pazocal{O}_X : X \rightarrow \mathrm{CRing}.
    $$
    A \emph{locally ringed space} is a ringed space $(X,\pazocal{O}_X)$ such that each stalk $\pazocal{O}_{X,P}$ for $P\in X$ is a local ring
\end{definition}
\begin{definition}
    A morphism of ringed spaces, $(X,\pazocal{O}_X)\rightarrow (Y,\pazocal{O}_Y)$ is a continuous map $f: X\rightarrow Y$ and a natural transformation $f^\# : \pazocal{O}_Y \Rightarrow f_\star \pazocal{O}_X$.
\end{definition}
We wish to define a morphism between locally ringed spaces. To do this we first show how to construct a ring homomorphism between the stalks $\pazocal{O}_{Y,f(P)}$ and $\pazocal{O}_{X,P}$ for each $P\in X$. Indeed, $f^\#$ induces a ring homomorphism 
$$
    \pazocal{O}_{Y,f(P)} = \varinjlim_{U\ni f(P)} \pazocal{O}(U)\rightarrow \varinjlim_{U\ni f(P)} \pazocal{O}_{X}\left(f^{-1}(U)\right) = \varinjlim_{f^{-1}(U)\ni P} \pazocal{O}_X\left(f^{-1}(U)\right)
$$
Composing this with 
$$
    \varinjlim_{f^{-1}(U)\ni P} \pazocal{O}_X\left(f^{-1}(U)\right)\hookrightarrow \varinjlim_{W\ni P} \pazocal{O}_X(W) = \pazocal{O}_{X,P},
$$
we obtain a map 
\begin{gather*}
    f^\#_P : \pazocal{O}_{Y,f(P)}\rightarrow \pazocal{O}_{X,P}
\end{gather*}
\begin{definition}\label{MorphismOfRingedSpaces}
    A morphism of locally ringed spaces is a morphism of ringed spaces $(f,f^\#):(X,\pazocal{O}_X)\rightarrow (Y,\pazocal{O}_Y)$ such that $f^\#_P$ is local ring homomorphism (cf. Definition~\ref{LocalRingDefinition}) for each $P\in X$. 
\end{definition}
\begin{lemma}
    \begin{enumerate}
        \item $\Spec \ R$ is a locally ringed space for each ring $R$.
        \item If $\sigma: A\rightarrow B$ is a map of rings, then it induces a morphism of locally ringed spaces
        \begin{gather*}
            (f,f^\#)_\sigma : (\Spec\ B, \pazocal{O}_{\Spec\ B}) \rightarrow (\Spec\ A, \pazocal{O}_{\Spec\ A})
        \end{gather*}
        \item The functor
        \begin{gather*}
            \Spec : \mathrm{CRing} \rightarrow \mathrm{LRS}\\
            R\mapsto \Spec\ R\\
            \sigma : A\rightarrow B \mapsto (f,f^\#)_\sigma
        \end{gather*}
    \end{enumerate}
    is fully faithful. Here $\mathrm{LRS}$ denotes the category of locally ringed spaces. 
\end{lemma}
\begin{proof}
    1. Follows from Lemma~\ref{StalkCorrespondToPrimeLocalizationSheafOnBasisSetCorrespondToLocalization} 1.\\
    We define 
    \begin{gather*}
        f : \Spec\ B\rightarrow \Spec \ A\\
        \mathfrak{p} \mapsto \sigma^{-1}(\mathfrak{p})
    \end{gather*}
    which is well-defined by Proposition~\ref{PreImageOfPrimeIdealUnderRingMapIsPrime}. For an ideal $I\subset A$ one readily verifies that $f^{-1}(V(I))=V(\sigma(I))$ {\Large I haven't actually defined what this means: DO!}, which shows that $f$ is continuous. For an open set $U\subset \Spec \ A $, we take 
    $$
        f^\#_U :\pazocal{O}_{\Spec \ A}(U)\rightarrow \left(f_\star\pazocal{O}_{\Spec\ B}\right)(U)= \pazocal{O}_{\Spec\ B}\left(f^{-1}(U)\right)
    $$
    to be ring map taking a section $s\in \pazocal{O}_{\Spec\ A}$ to the section
    \begin{gather*}
        f^{-1}(U) \rightarrow \bigcup_{\mathfrak{p}\in f^{-1}(U)} B_\mathfrak{p}\\
        \mathfrak{p} \mapsto \sigma_\mathfrak{p}(s\circ \varphi)(\mathfrak{p})
    \end{gather*}
    where $\sigma_\mathfrak{p}: A_\mathfrak{p}\rightarrow B_{f^{-1}(\mathfrak{p})}$ is the localization of $\sigma$ with respect to $\mathfrak{p}$. We check the naturality condition: Suppose $U\subset V$. Then for $s\in \pazocal{O}_{\Spec\ A}(U)$ and $\mathfrak{p}\in f^{-1}(V)$, 
    \begin{align*}
        \left.f^\#_U\right|(s)_{f^{-1}(V)}(\mathfrak{p})=\sigma_\mathfrak{p}((s\circ f)(\mathfrak{p}))= \sigma_\mathfrak{p}\left(\left(\left.s\right|_V\circ f\right)(\mathfrak{p})\right)=f^\#_V\left(\left.s\right|_V\right)(\mathfrak{p}).
    \end{align*}
    Let $\mathfrak{p}\in \Spec \ B $ and $(U,s)\in \pazocal{O}_{\Spec A,\mathfrak{p}}$. Then 
    $$
        \left(f^\#_{f(\mathfrak{p})}(s)\right)(\mathfrak{p})= f^\#_U(s)(\mathfrak{p})= \sigma_\mathfrak{p}(s(f(\mathfrak{p}))) =  \sigma\left(s\left(\sigma^{-1}(\mathfrak{p})\right)\right),
    $$
    hence the square
    $$
        \begin{tikzcd}
            \pazocal{O}_{\Spec\ A, f(\mathfrak{p})} \arrow[r,"f^\#_{\mathfrak{p}}"]\arrow[d,"\ev_{f(\mathfrak{p})}"] & \pazocal{O}_{\Spec\ B, \mathfrak{p}} \arrow[d,"\ev_{\mathfrak{p}}"]\\
            A_{\sigma^{-1}(\mathfrak{p})} \arrow[r,"\sigma_\mathfrak{p}"] & B_\mathfrak{p}
        \end{tikzcd}
    $$
    commutes. Since $\ev_{f(\mathfrak{p})}$ and $\ev_\mathfrak{p}$ are isomorphisms, it follows that $f^\#_\mathfrak{p}$ is a local ring homomorphism. We thus conclude that $(f,f^\#)_\sigma$ is a morphism of locally ringed spaces.\\
    3. Let a morphism of locally ringed spaces $(f,f^\#): (\Spec\ B,\pazocal{O}_{\Spec \ B})\rightarrow (\Spec \ A, \pazocal{O}_{\Spec\ A})$. Then there is a ring map 
    $$
        \sigma:=f^\#_{\Spec\ A} : A\simeq \Gamma(\Spec\ A, \pazocal{O}_{\Spec\ A})\rightarrow \Gamma(\Spec \ A, \pazocal{O}_{\Spec\ B})\simeq B
    $$
    We check that $(g, g^\#)_{\sigma}=(f,f^\#)$. 
    For a $\mathfrak{p}\in \Spec\ B$, consider the local ring homomorphism (cf. Definition~{MorphismOfRingedSpaces})
    $$
        \sigma_\mathfrak{p} : A_{f(\mathfrak{p})} \rightarrow B_\mathfrak{p}
    $$
    Note that
    $$
        \sigma^{-1}(\mathfrak{p})=\sigma_\mathfrak{p}^{-1}(\mathfrak{m}_\mathfrak{p}\cap B) = \mathfrak{m}_{f(\mathfrak{p})}\cap A = f(\mathfrak{p})
    $$
    hence $g$ and $f$ agree.  
\end{proof}
\begin{definition}
    An \emph{affine scheme} is a locally ringed space $(X,\pazocal{O}_X)$ isomorphic to $(\Spec \ R, \pazocal{O})$ for some ring $R$ as locally ringed spaces. 
\end{definition}
\subsubsection{Schemes}
\begin{definition}
    A \emph{scheme} is a locally ringed space $(X,\pazocal{O}_X)$ where for each $P\in X$ there is an open neighborhood $U$ of $P$ such that $(U,\left.\pazocal{O}_X\right|_U)$ is an affine scheme. I.e. there is an open covering of $X$ where each open set in the covering is an affine scheme. 
\end{definition}

